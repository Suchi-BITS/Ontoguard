# OntoGuard: Ontology Firewall - Environment Configuration
# Copy this file to .env and configure for your environment

# ============================================================================
# CORE CONFIGURATION
# ============================================================================

# Path to ontology file (JSON, YAML, or OWL)
ONTOLOGY_PATH=ontologies/enterprise.json

# Ontology format (json, yaml, owl)
ONTOLOGY_FORMAT=json

# Enable ontology hot-reloading (reload when file changes)
ENABLE_HOT_RELOAD=false

# Ontology validation on load (strict=fail on error, lenient=warn only)
ONTOLOGY_VALIDATION=strict

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Log file path
LOG_FILE=ontoguard.log

# Enable structured JSON logging
STRUCTURED_LOGGING=false

# Log validation decisions (true/false)
LOG_VALIDATIONS=true

# Log denied actions only (false = log all)
LOG_DENIED_ONLY=false

# ============================================================================
# AUDIT DATABASE
# ============================================================================

# Database type: sqlite, postgresql, mysql
AUDIT_DB_TYPE=sqlite

# SQLite path
AUDIT_DB_PATH=ontoguard_audit.db

# PostgreSQL connection (if using PostgreSQL)
# POSTGRES_HOST=localhost
# POSTGRES_PORT=5432
# POSTGRES_USER=ontoguard
# POSTGRES_PASSWORD=your-secure-password
# POSTGRES_DATABASE=ontoguard_audit

# Audit log retention in days (0 = unlimited)
AUDIT_RETENTION_DAYS=365

# Enable audit log compression (for old entries)
ENABLE_AUDIT_COMPRESSION=true

# ============================================================================
# VALIDATION BEHAVIOR
# ============================================================================

# Default validation mode: strict, lenient, advisory
# strict = block invalid actions
# lenient = allow but log violations
# advisory = suggest but never block
VALIDATION_MODE=strict

# Enable validation caching (cache results for repeated contexts)
ENABLE_VALIDATION_CACHE=true

# Cache TTL in seconds
VALIDATION_CACHE_TTL=300

# Maximum validation time before timeout (milliseconds)
VALIDATION_TIMEOUT_MS=100

# ============================================================================
# RULE ENGINE
# ============================================================================

# Rule evaluation strategy: first-fail, all-evaluate
# first-fail = stop on first violation (faster)
# all-evaluate = check all rules (better error messages)
RULE_EVALUATION_STRATEGY=all-evaluate

# Enable rule priority sorting
ENABLE_RULE_PRIORITY=true

# Default rule priority (lower = higher priority)
DEFAULT_RULE_PRIORITY=100

# Maximum rules to evaluate per validation
MAX_RULES_PER_VALIDATION=100

# ============================================================================
# MCP SERVER CONFIGURATION
# ============================================================================

# Enable MCP server
ENABLE_MCP_SERVER=true

# MCP server host
MCP_HOST=0.0.0.0

# MCP server port
MCP_PORT=5000

# Enable MCP authentication
ENABLE_MCP_AUTH=false

# MCP API key (if authentication enabled)
MCP_API_KEY=your-mcp-api-key-here

# Enable CORS for web clients
ENABLE_CORS=true

# Allowed CORS origins (comma-separated)
CORS_ORIGINS=http://localhost:3000,http://localhost:8080

# ============================================================================
# PERMISSION SYSTEM
# ============================================================================

# Enable role-based access control
ENABLE_RBAC=true

# Default role for agents without specified role
DEFAULT_AGENT_ROLE=agent

# Require explicit permissions (false = allow by default)
REQUIRE_EXPLICIT_PERMISSIONS=true

# Permission inheritance (roles inherit from parent roles)
ENABLE_PERMISSION_INHERITANCE=true

# ============================================================================
# TEMPORAL RULES
# ============================================================================

# Timezone for temporal validation
TIMEZONE=UTC

# Enable business hours enforcement
ENABLE_BUSINESS_HOURS=false

# Business hours (24-hour format, comma-separated)
BUSINESS_HOURS_START=9
BUSINESS_HOURS_END=17

# Business days (0=Monday, 6=Sunday, comma-separated)
BUSINESS_DAYS=0,1,2,3,4

# ============================================================================
# QUANTITATIVE RULES
# ============================================================================

# Enable automatic currency conversion
ENABLE_CURRENCY_CONVERSION=false

# Base currency
BASE_CURRENCY=USD

# Enable amount threshold warnings (warn before deny)
ENABLE_AMOUNT_WARNINGS=true

# Warning threshold percentage (warn at X% of limit)
AMOUNT_WARNING_THRESHOLD=80

# ============================================================================
# PERFORMANCE
# ============================================================================

# Enable performance monitoring
ENABLE_PERFORMANCE_MONITORING=true

# Performance metrics collection interval (seconds)
METRICS_COLLECTION_INTERVAL=60

# Enable slow validation logging (log if > threshold)
LOG_SLOW_VALIDATIONS=true

# Slow validation threshold (milliseconds)
SLOW_VALIDATION_THRESHOLD_MS=50

# Enable async validation for non-critical paths
ENABLE_ASYNC_VALIDATION=false

# ============================================================================
# METRICS AND MONITORING
# ============================================================================

# Enable Prometheus metrics endpoint
ENABLE_PROMETHEUS_METRICS=false

# Prometheus metrics port
PROMETHEUS_PORT=9090

# Enable health check endpoint
ENABLE_HEALTH_CHECK=true

# Health check endpoint path
HEALTH_CHECK_PATH=/health

# Enable metrics dashboard
ENABLE_METRICS_DASHBOARD=false

# Dashboard port
DASHBOARD_PORT=8080

# ============================================================================
# ALERTING
# ============================================================================

# Enable alerting
ENABLE_ALERTING=false

# Alert on high denial rate
ALERT_ON_HIGH_DENIAL_RATE=true

# High denial rate threshold (percentage)
HIGH_DENIAL_RATE_THRESHOLD=50

# Alert email (comma-separated)
ALERT_EMAILS=admin@example.com,security@example.com

# Slack webhook for alerts
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL

# Alert cooldown period (seconds)
ALERT_COOLDOWN_SECONDS=3600

# ============================================================================
# ERROR HANDLING
# ============================================================================

# Default action on validation error: allow, deny, require_approval
DEFAULT_ON_ERROR=deny

# Enable detailed error messages
ENABLE_DETAILED_ERRORS=true

# Include rule IDs in error messages
INCLUDE_RULE_IDS_IN_ERRORS=true

# Suggest alternative actions on denial
SUGGEST_ALTERNATIVES=true

# Maximum suggestions per denial
MAX_SUGGESTIONS=3

# ============================================================================
# ONTOLOGY SOURCES
# ============================================================================

# Support for multiple ontologies
ENABLE_MULTI_ONTOLOGY=false

# Ontology directory (for multiple ontologies)
ONTOLOGY_DIR=ontologies/

# Ontology merge strategy: union, intersection, priority
ONTOLOGY_MERGE_STRATEGY=union

# Remote ontology URL (for dynamic loading)
REMOTE_ONTOLOGY_URL=

# Remote ontology refresh interval (seconds)
REMOTE_ONTOLOGY_REFRESH=3600

# ============================================================================
# SECURITY
# ============================================================================

# Enable ontology encryption at rest
ENABLE_ONTOLOGY_ENCRYPTION=false

# Encryption key for ontology files
ONTOLOGY_ENCRYPTION_KEY=your-encryption-key-here

# Enable ontology signature verification
ENABLE_ONTOLOGY_SIGNING=false

# Public key for signature verification
ONTOLOGY_PUBLIC_KEY_PATH=keys/ontology.pub

# Enable audit log encryption
ENABLE_AUDIT_ENCRYPTION=false

# Rate limit validations per agent (N/period)
RATE_LIMIT_PER_AGENT=1000/minute

# ============================================================================
# INTEGRATION
# ============================================================================

# Integration with external systems

# LangChain integration
ENABLE_LANGCHAIN_INTEGRATION=false

# AutoGen integration
ENABLE_AUTOGEN_INTEGRATION=false

# CrewAI integration
ENABLE_CREWAI_INTEGRATION=false

# Custom webhook for validation events
WEBHOOK_URL=

# Webhook events to send (comma-separated: all, denied, allowed, error)
WEBHOOK_EVENTS=denied,error

# ============================================================================
# DEVELOPMENT / TESTING
# ============================================================================

# Enable demo mode with sample ontology
DEMO_MODE=false

# Enable test mode (bypass certain validations)
TEST_MODE=false

# Enable debug mode (verbose logging)
DEBUG_MODE=false

# Enable mock validation (always return allowed)
MOCK_VALIDATION=false

# Enable validation replay (replay from audit log)
ENABLE_VALIDATION_REPLAY=false

# ============================================================================
# COMPLIANCE
# ============================================================================

# Compliance framework: none, sox, hipaa, gdpr, pci-dss
COMPLIANCE_FRAMEWORK=none

# Enable PII detection in context
ENABLE_PII_DETECTION=false

# Mask PII in audit logs
MASK_PII_IN_LOGS=true

# Enable data retention policies
ENABLE_DATA_RETENTION_POLICIES=true

# Minimum audit retention for compliance (days)
MIN_AUDIT_RETENTION_DAYS=365

# ============================================================================
# AGENT SPECIFIC
# ============================================================================

# Default agent timeout (seconds)
DEFAULT_AGENT_TIMEOUT=30

# Enable agent registry (track all agents)
ENABLE_AGENT_REGISTRY=true

# Require agent registration before validation
REQUIRE_AGENT_REGISTRATION=false

# Maximum actions per agent per hour
MAX_ACTIONS_PER_AGENT_HOUR=1000

# ============================================================================
# ADVANCED FEATURES
# ============================================================================

# Enable machine learning for rule suggestions
ENABLE_ML_RULE_SUGGESTIONS=false

# ML model path for rule suggestions
ML_MODEL_PATH=models/rule_suggester.pkl

# Enable automatic ontology generation from schemas
ENABLE_AUTO_ONTOLOGY_GENERATION=false

# Database schema path for auto-generation
SCHEMA_PATH=schemas/

# Enable conflict resolution for multi-ontology
ENABLE_CONFLICT_RESOLUTION=true

# Conflict resolution strategy: first-wins, last-wins, most-restrictive
CONFLICT_RESOLUTION_STRATEGY=most-restrictive

# ============================================================================
# ENTERPRISE FEATURES
# ============================================================================

# Enable multi-tenancy
ENABLE_MULTI_TENANCY=false

# Tenant isolation mode: strict, shared-database, dedicated-database
TENANT_ISOLATION_MODE=strict

# Enable SSO integration
ENABLE_SSO=false

# SSO provider: okta, auth0, azure-ad, google
SSO_PROVIDER=okta

# SSO configuration URL
SSO_CONFIG_URL=

# Enable enterprise audit export
ENABLE_AUDIT_EXPORT=false

# Audit export format: csv, json, parquet
AUDIT_EXPORT_FORMAT=json

# Audit export destination: s3, gcs, azure-blob, local
AUDIT_EXPORT_DESTINATION=local

# ============================================================================
# NOTES
# ============================================================================

# 1. Never commit .env file to version control
# 2. Use environment-specific .env files (.env.dev, .env.prod)
# 3. Validate ontology syntax before deployment
# 4. Monitor validation metrics in production
# 5. Set appropriate audit retention based on compliance requirements
# 6. Test rule changes in staging before production
# 7. Keep ontologies versioned in source control
# 8. Document all business rules with examples
# 9. Review denied actions regularly for rule refinement
# 10. Implement proper secret management for production

# ============================================================================
# QUICK START
# ============================================================================

# Minimal configuration to get started:
# 1. Set ONTOLOGY_PATH to your ontology file
# 2. Set LOG_LEVEL to INFO or DEBUG
# 3. Set AUDIT_DB_PATH to desired location
# 4. Run: python ontoguard.py

# Example:
# ONTOLOGY_PATH=my_business_rules.json
# LOG_LEVEL=INFO
# AUDIT_DB_PATH=audit.db
# VALIDATION_MODE=strict
